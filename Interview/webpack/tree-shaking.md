## Tree Sharking

> 简单来说：就是消除无用代码的过程，tree sharking 借助了 es6 模块化的 esm 的静态解析能力，通过 AST（抽象语法树） 找到没有引入的模块并打标，然后利用压缩工具 `Uglify` 删除无用代码的过程，是一种性能优化的手段（在 webpack 中就是通过这种方式去除一些没有用到的模块，减少打包体积）

### Dead code

> Tree-Shaking，就是 Dead code 消除的一种实现，借助了 ESM 的静态分析能力，对无用模块进行消除

- 定义
  1. 不会被运行到的代码
  2. 只会影响到无关程序运行结果的变量

### ESM 静态解析

- 在编译时就可以明确知道 import 或 export 了哪些模块。
- 只能在文件顶层 import 或 export 模块，不能在条件语句中使用。
- import 或 export 的模块名只能是字符串常量。
- export 导出的模块是一个值的引用，而非值的拷贝。

### 步骤

- 构建抽象语法树（AST）：从项目的入口文件开始，打包工具会递归地分析所有导入的模块，并将每个模块以及它们之间的依赖关系构建成一个抽象语法树。

- 标记使用过的代码：在构建过程中，工具会运行所有代码，以确定哪些变量和函数实际上被使用过。对那些在运行时未被引用过的代码，工具会做标记。

- 清除未被使用的代码：一旦标记完成，打包工具会根据这些标记清除 AST 中所有未被使用的代码部分。
