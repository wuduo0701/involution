> 大促期间，服务端数据变化比较快，需要实时把新信息推送给前端，由此引出 web 即时通讯技术，即服务器端可以即时地将数据的更新或变化反应到客户端

# SSE

> HTML5 的新特性，消息推送机制

1. 实现服务端主动向客户端推送数据
2. 客户端只需要第一次发送请求，建立长连接。后期只需要服务器就可以一直向客户端发生数据。
3. 可以理解为这种模式是服务器到客户端的单向连接模式，只允许服务器向客户端发送消息。

- 单向通信：服务器可以主动向客户端推送数据，但客户端不能向服务器发送数据。
- 长连接：客户端与服务器之间建立一个持久的 HTTP 连接，服务器可以通过这个连接持续发送数据给客户端。
- 简单实现：浏览器原生支持，通过 JavaScript 的 EventSource 对象即可实现。
- 文本数据：主要用于传输文本数据，适合简单的消息推送。

## 优点

- 实现简单，浏览器支持良好。
- 适合需要频繁更新的小量数据推送。
- 自带自动重连机制

## 缺点

客户端一般不会主动关闭连接，当连接一直不关闭，随着客户端连接越来越多，服务端保持过多连接，会增加服务器开销。
所以用这个限制打开次数。
长时间无操作自动断开、回到页面自动连接

# websocket

- 双向通信：客户端和服务器可以互相发送数据。
- 全双工通信：建立一个持久的 TCP 连接，实现低延迟的实时通信。
- 高效：相比于 HTTP 轮询，WebSocket 开销更小，适合高频率的数据交换。
- 支持二进制数据：可以传输文本和二进制数据。

WebSocket 连接的建立是通过 HTTP 握手过程来升级到 WebSocket 协议，之后的通信不再遵循 HTTP 协议

## 缺点

- 实现相对复杂
- 虽然性能优于 SSE，但是对于大屏系统有点大材小用了。

# 短轮询

# 长轮询

# 比较

从兼容性角度：轮询>长轮询>SSE>WebSocket

从性能方面考虑：WebSocket>SSE>长轮询>轮询

综合考虑：

1. SSE 的单向数据流推送机制、 已经完全能满足业务场景
2. 实现更加简单。简化的通信模型
3. websocket 相对更复杂，优点大材小用了
4. 自带重连机制，当连接断开时，浏览器会自动尝试重新连接
5.

但是有这些还是不够保证系统的稳定性
