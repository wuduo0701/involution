# js 如何监听 dom 的变化

1. 事件冒泡：利用某些事件的冒泡特性，例如 input 事件可以监听输入框内容的变化。
2. MutationObserver
   ```js
   const observer = new MutationObserver((mutationsList, observer) => {
     for (const mutation of mutationsList) {
       if (mutation.type === 'attributes') {
         console.log(`属性 ${mutation.attributeName} 发生了变化`)
       }
       // 处理其他类型的变化
     }
   })
   const targetNode = document.getElementById('yourElementId')
   observer.observe(targetNode, { attributes: true })
   ```

# 回流和重绘

> 回流必定会发生重绘，重绘不一定会引发回流
> 回流的成本很高，尽量减少发生回流

1. 回流：会影响文档流的布局和绘制
   1. 页面首次渲染
   2. 改变字体大小
   3. 改变视窗大小
   4. 添加或者删除样式
   5. 读取某些元素（浏览器需要确保获取到的布局信息是最新的）
2. 重绘：会改变文档的外观。

# 一帧中浏览器做了哪些行为

> 如用户输入某某改变了页面样式

1. 执行宏任务
2. 执行所有微任务
3. 执行 requestAnimationFrame
4. 更新动画和样式。计算 DOM 样式的位置及其样式更新，JS 可以手动操作 DOM
5. 布局（回流）。重新计算页面的布局，更新 DOM 位置
6. 绘制（重绘）。更新 DOM 样式
7. 显示更新。
