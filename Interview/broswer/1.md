# 事件机制

> 浏览器中，事件机制的触发顺序为`捕获 -> 目标阶段 -> 冒泡`

- 注册事件
  - 一般使用 addEventListener(name, callback, boolean)
  - 第一个参数为事件名称、第二事件为回调函数、boolean 值为触发的时机。false 为`冒泡`时触发、true 则为`捕获`时触发。默认为 false
- 阻止事件冒泡
  - stopPropagation
  - stopImmediaPropagation
  - !!二者区别：当使用`stopPropagation`时，window 的 click 不会被触发。当使用`sstopImmediatePropagation`时，DOM 的捕获事件不会触发(阻止目标执行别的注册事件)，window 的 click 不会触发

# 跨域

## 什么是同源

页面的协议，域名和端口都相同则属于同源

## 什么是跨域

非同源请求，均是跨域。只要协议、域名、端口号其中任意一者不同，均属跨域。

## 跨域解决方案

1. document.domain + iframe 跨域
   此方案仅限主域相同，子域不同的跨域应用场景。
2. postMessage 跨域
3. JSONP 跨域
   因为通过 script 标签引入的 js 是不受同源策略的限制的
4. CORS 跨域
   服务端设置
   ```conf
    add_header Access-Control-Allow-Origin $cors_origin;
    add_header Access-Control-Allow-Methods 'GET, POST, OPTIONS';
    add_header Access-Control-Allow-Credentials true;
    add_header Access-Control-Allow-Private-Network true;
   ```
5. Nginx 跨域
   通过 nginx 配置一个代理服务器
6. Node 跨域
   node 中间件实现跨域代理
